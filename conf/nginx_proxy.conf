server {
    server_name  jondy.net;
    listen  80;
    listen  443 ssl;
    ssl_certificate /home/www/jondy.net/conf/letsencrypt/jondy.chained.crt;
    ssl_certificate_key /home/www/jondy.net/conf/letsencrypt/jondy.key;
    error_page 404  /404.html;
    error_page  500 502 503 504  /50x.html; 

    location / {
        root  /home/www/jondy.net/output;
        index index.html;
    }

    location ^~ /.well-known/{
        alias /home/www/jondy.net/conf/.well-known/;
        # autoindex on;
        expires 24h;
        access_log off;
    }

    location  ^~ /404.html {
        alias /home/www/jondy.net/conf/error_pages/404.html;
        expires 24h;
        access_log  off;
        break;
    }

    location  ^~ /50x.html {
        alias /home/www/jondy.net/conf/error_pages/50x.html;
        expires 24h;
        access_log  off;
        break;
    }

    location  ^~ /robots.txt {
        alias /home/www/jondy.net/conf/robots.txt;
        expires 24h;
        access_log  off;
        break;
    }

    location  ^~ /favicon.ico {
        alias /home/www/jondy.net/conf/favicon.ico;
        expires 48h;
        access_log  off;
        break;
    }
}

upstream  note.jondy.net  {
	server   localhost:20000;
}

# http
server
{
	listen  80;
	server_name  note.jondy.net;

	location / {
		proxy_pass        http://note.jondy.net;
		proxy_set_header   Host             $host;
		proxy_set_header   X-Real-IP        $remote_addr;
		proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
	}
}

#server {
#    listen  80;
#    server_name  jondy.net;
#    # access_log /home/jondy.net/logs/nginx_access.log main;
#    # error_log  /home/jondy.net/logs/nginx_error.log ;
#
#    location / {
#        client_max_body_size    10m;
#        proxy_read_timeout 1800;
#        proxy_pass_header Server;
#        proxy_redirect off;
#        proxy_set_header Host $http_host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Scheme $scheme;
#        proxy_set_header REMOTE_ADDR $remote_addr;
#        proxy_set_header X-Forwarded-For $remote_addr;
#        proxy_pass http://127.0.0.1:8888;
#    }
#
#    location ^~ /static/{
#        alias /home/www/jondy.net/web/static/;
#        expires 24h;
#        access_log off;
#    }
#
#    location ^~ /pages/{
#        alias /home/www/jondy.net/pages/;
#        expires 2h;
#        access_log off;
#    }
#
#    location ^~ /static/admin/ {
#        alias /usr/local/lib/python2.7/dist-packages/django/contrib/admin/static/admin/;
#        access_log      off;
#    }
#}
#
#server {
#    listen  80;
#    server_name  www.jondy.net;
#    rewrite ^(.*) http://jondy.net permanent;
#}
#
#server
#{
#    listen 443;
#    server_name  jondy.net;
#    ssl on;
#    ssl_certificate /home/www/jondy.net/conf/cert/server.crt;
#    ssl_certificate_key /home/www/jondy.net/conf/cert/server.key;
#
#    location / {
#        client_max_body_size    10m;
#        proxy_read_timeout 1800;
#        proxy_pass_header Server;
#        proxy_redirect off;
#        proxy_set_header Host $http_host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Scheme $scheme;
#        proxy_set_header REMOTE_ADDR $remote_addr;
#        proxy_set_header X-Forwarded-For $remote_addr;
#        proxy_pass http://127.0.0.1:8888;
#    }
#
#    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|mp3|wma)$
#    {
#        expires      30d;
#    }
#
#    location ~ .*\.(js|css)$
#    {
#        expires      12h;
#    }
#
#    location  ^~ /robots.txt {
#        alias /home/www/jondy.net/conf/robots.txt;
#        expires 24h;
#        access_log  off;
#        break;
#    }
#    location  ^~ /favicon.ico {
#        alias /home/www/jondy.net/web/static/favicon.ico;
#        expires 48h;
#        access_log  off;
#        break;
#    }
#
#    location ^~ /static/{
#        alias /home/www/jondy.net/web/static/;
#        expires 24h;
#        access_log off;
#    }
#
#    location ^~ /pages/{
#        alias /home/www/jondy.net/pages/;
#        expires 2h;
#        access_log off;
#    }
#
#    location ^~ /static/admin/ {
#        alias /usr/local/lib/python2.7/dist-packages/django/contrib/admin/static/admin/;
#        access_log      off;
#    }
#}

server {
    listen  80;
    server_name  jokes.jondy.net;

    location / {
        client_max_body_size    10m;
        add_header Access-Control-Allow-Origin *;
        proxy_set_header Access-Control-Allow-Origin $http_origin;
        proxy_read_timeout 1800;
        proxy_pass_header Server;
        proxy_redirect off;
        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_set_header REMOTE_ADDR $remote_addr;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_pass http://127.0.0.1:8000;
    }
}
